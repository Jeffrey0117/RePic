# è™›æ“¬åœ–ç‰‡ (Virtual Image) åŠŸèƒ½è¦æ ¼

## æ¦‚è¿°

å¯¦ç¾ `.repic` è™›æ“¬åœ–ç‰‡æª”æ¡ˆæ ¼å¼ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥åœ¨æœ¬åœ°æª”æ¡ˆç³»çµ±ä¸­ç®¡ç†ç¶²è·¯åœ–ç‰‡çš„ã€Œæ·å¾‘ã€ï¼Œé›™æ“Šå³å¯ç”¨ Repic é–‹å•Ÿç€è¦½ï¼Œå¯¦ç¾è¶…è¼•é‡çš„åœ–ç‰‡æ”¶è—ç®¡ç†ã€‚

**æ ¸å¿ƒåƒ¹å€¼ï¼š**
- 100GB ç¶²è·¯åœ–ç‰‡ â†’ å¹¾ MB çš„ `.repic` æ·å¾‘æª”æ¡ˆ
- å¯åœ¨ Windows æª”æ¡ˆç¸½ç®¡ä¸­æ•´ç†ã€æœå°‹ã€å‚™ä»½
- é›™æ“Šå³é–‹ï¼Œç„¡ç¸«é«”é©—

---

## æª”æ¡ˆæ ¼å¼å®šç¾©

### `.repic` æª”æ¡ˆçµæ§‹

```json
{
  "v": 1,
  "type": "virtual-image",
  "url": "https://i.imgur.com/example.jpg",
  "name": "sunset-beach",
  "albumId": "abc123",
  "imageId": "xyz789",
  "createdAt": 1706000000000
}
```

| æ¬„ä½ | é¡å‹ | å¿…å¡« | èªªæ˜ |
|------|------|------|------|
| `v` | number | âœ“ | æ ¼å¼ç‰ˆæœ¬è™Ÿï¼Œç›®å‰ç‚º 1 |
| `type` | string | âœ“ | å›ºå®šç‚º `"virtual-image"` |
| `url` | string | âœ“ | åœ–ç‰‡çš„ç¶²è·¯ URL |
| `name` | string | âœ— | åœ–ç‰‡åç¨±ï¼ˆé¡¯ç¤ºç”¨ï¼‰ |
| `albumId` | string | âœ— | ä¾†æºç›¸ç°¿ IDï¼ˆå¯é¸ï¼Œç”¨æ–¼è¿½æº¯ï¼‰ |
| `imageId` | string | âœ— | ä¾†æºåœ–ç‰‡ IDï¼ˆå¯é¸ï¼‰ |
| `createdAt` | number | âœ— | å»ºç«‹æ™‚é–“æˆ³ |

### æª”æ¡ˆå¤§å°ä¼°ç®—
- å–®æª”ç´„ 150-300 bytes
- 1,000 å¼µåœ–ç‰‡ â‰ˆ 300 KB
- 10,000 å¼µåœ–ç‰‡ â‰ˆ 3 MB

---

## åŠŸèƒ½éœ€æ±‚

### 1. æª”æ¡ˆé—œè¯è¨»å†Š
- å®‰è£ Repic æ™‚è‡ªå‹•è¨»å†Š `.repic` å‰¯æª”å
- æª”æ¡ˆåœ–ç¤ºé¡¯ç¤º Repic LOGO
- é›™æ“Š `.repic` æª”æ¡ˆè‡ªå‹•é–‹å•Ÿ Repic

### 2. é–‹æª”è™•ç†
- Repic å•Ÿå‹•æ™‚æª¢æŸ¥æ˜¯å¦æœ‰å‚³å…¥ `.repic` æª”æ¡ˆè·¯å¾‘
- è§£ææª”æ¡ˆå…§å®¹ï¼Œå–å¾—åœ–ç‰‡ URL
- ç›´æ¥é€²å…¥åœ–ç‰‡ç€è¦½æ¨¡å¼

### 3. æœ¬åœ°æ¨¡å¼æ”¯æ´
- é–‹å•Ÿè³‡æ–™å¤¾æ™‚ï¼ŒåŒæ™‚æƒæ `.repic` æª”æ¡ˆ
- `.repic` æª”æ¡ˆèˆ‡ä¸€èˆ¬åœ–ç‰‡æ··åˆé¡¯ç¤º
- ç¸®åœ–é¡¯ç¤ºå¯¦éš›ç¶²è·¯åœ–ç‰‡ï¼ˆè¼‰å…¥ä¸­é¡¯ç¤º LOGOï¼‰

### 4. åŒ¯å‡ºåŠŸèƒ½
- ç¶²è·¯ç›¸ç°¿æ–°å¢ã€ŒåŒ¯å‡ºæ·å¾‘ã€æŒ‰éˆ•
- é¸æ“‡ç›®æ¨™è³‡æ–™å¤¾
- æ‰¹é‡ç”Ÿæˆ `.repic` æª”æ¡ˆ
- æª”åæ ¼å¼ï¼š`{name}.repic` æˆ– `{index}-{name}.repic`

### 5. å»ºç«‹åŠŸèƒ½
- åœ¨æœ¬åœ°æ¨¡å¼ä¸‹ï¼Œå¯ç›´æ¥è²¼ä¸Š URL å»ºç«‹ `.repic` æª”æ¡ˆ
- å³éµé¸å–®ï¼šã€Œæ–°å¢è™›æ“¬åœ–ç‰‡ã€

---

## UI è¨­è¨ˆ

### åŒ¯å‡ºå°è©±æ¡†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŒ¯å‡ºè™›æ“¬åœ–ç‰‡æ·å¾‘                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  ç›¸ç°¿ï¼šæˆ‘çš„æ”¶è— (25 å¼µåœ–ç‰‡)               â”‚
â”‚                                         â”‚
â”‚  ç›®æ¨™è³‡æ–™å¤¾ï¼š                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” [ç€è¦½...]  â”‚
â”‚  â”‚ D:\Pictures\Collection  â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                         â”‚
â”‚  æª”åæ ¼å¼ï¼š                              â”‚
â”‚  â—‹ ä½¿ç”¨åœ–ç‰‡åç¨± (sunset.repic)           â”‚
â”‚  â— åŠ ä¸Šåºè™Ÿ (001-sunset.repic)           â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  å–æ¶ˆ   â”‚  â”‚  åŒ¯å‡º   â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æœ¬åœ°æ¨¡å¼ - æ··åˆé¡¯ç¤º

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ D:\Pictures\Mixed                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ JPG â”‚  â”‚ PNG â”‚  â”‚ ğŸ”—  â”‚  â”‚ ğŸ”—  â”‚  â”‚ JPG â”‚       â”‚
â”‚  â”‚     â”‚  â”‚     â”‚  â”‚REPICâ”‚  â”‚REPICâ”‚  â”‚     â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  local1   local2   virtual1 virtual2  local3        â”‚
â”‚                                                      â”‚
â”‚  ğŸ”— = è™›æ“¬åœ–ç‰‡ï¼ˆé¡¯ç¤ºç¶²è·¯ç¸®åœ–æˆ–è¼‰å…¥ä¸­ LOGOï¼‰           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é–‹æª”ç›´æ¥ç€è¦½

```
é›™æ“Š sunset.repic
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Repic                                    [â”€][â–¡][Ã—] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚              â”‚                     â”‚                â”‚
â”‚              â”‚    ğŸŒ… sunset.jpg    â”‚                â”‚
â”‚              â”‚    (å¾ç¶²è·¯è¼‰å…¥)      â”‚                â”‚
â”‚              â”‚                     â”‚                â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                      â”‚
â”‚  â—€ ä¸Šä¸€å¼µï¼ˆå¦‚æœåŒè³‡æ–™å¤¾æœ‰å…¶ä»– .repicï¼‰  ä¸‹ä¸€å¼µ â–¶     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æŠ€è¡“å¯¦ç¾

### 1. Electron æª”æ¡ˆé—œè¯

**electron-builder è¨­å®š (electron-builder.json æˆ– package.json):**

```json
{
  "fileAssociations": [
    {
      "ext": "repic",
      "name": "Repic Virtual Image",
      "description": "Repic Virtual Image File",
      "icon": "build/icon.ico",
      "role": "Viewer"
    }
  ]
}
```

### 2. ä¸»é€²ç¨‹é–‹æª”è™•ç†

**main.js ä¿®æ”¹ï¼š**

```javascript
// Windows: æª”æ¡ˆè·¯å¾‘æœƒåœ¨ process.argv
const filePath = process.argv.find(arg => arg.endsWith('.repic'));

// macOS: ä½¿ç”¨ open-file äº‹ä»¶
app.on('open-file', (event, path) => {
  event.preventDefault();
  handleRepicFile(path);
});

// è™•ç† .repic æª”æ¡ˆ
async function handleRepicFile(filePath) {
  const content = await fs.readFile(filePath, 'utf-8');
  const data = JSON.parse(content);

  // å‚³é€åˆ° renderer
  mainWindow.webContents.send('open-virtual-image', {
    ...data,
    filePath,
    folderPath: path.dirname(filePath)
  });
}
```

### 3. æ¸²æŸ“é€²ç¨‹è™•ç†

**preload.js æ–°å¢ï¼š**

```javascript
contextBridge.exposeInMainWorld('electronAPI', {
  // ... ç¾æœ‰ API
  onOpenVirtualImage: (callback) => {
    ipcRenderer.on('open-virtual-image', (_, data) => callback(data));
  },
  writeRepicFile: (filePath, data) => {
    return ipcRenderer.invoke('write-repic-file', filePath, data);
  },
  readRepicFile: (filePath) => {
    return ipcRenderer.invoke('read-repic-file', filePath);
  }
});
```

### 4. æœ¬åœ°æ¨¡å¼æ•´åˆ

**ä¿®æ”¹ readDirectory é‚è¼¯ï¼š**

```javascript
// ç¾æœ‰ï¼šåªè®€å–åœ–ç‰‡æª”æ¡ˆ
const imageExtensions = ['.jpg', '.jpeg', '.png', '.gif', '.webp', '.bmp'];

// æ–°å¢ï¼šä¹Ÿè®€å– .repic æª”æ¡ˆ
const supportedExtensions = [...imageExtensions, '.repic'];

// è™•ç† .repic æª”æ¡ˆ
async function processFile(filePath) {
  if (filePath.endsWith('.repic')) {
    const content = await fs.readFile(filePath, 'utf-8');
    const data = JSON.parse(content);
    return {
      type: 'virtual',
      path: filePath,
      url: data.url,
      name: data.name || path.basename(filePath, '.repic')
    };
  }
  return {
    type: 'local',
    path: filePath,
    name: path.basename(filePath)
  };
}
```

---

## æª”æ¡ˆçµæ§‹

```
src/
â”œâ”€â”€ App.jsx                          # è™•ç† open-virtual-image äº‹ä»¶
â”œâ”€â”€ components/ui/
â”‚   â”œâ”€â”€ Sidebar.jsx                  # æ”¯æ´é¡¯ç¤º .repic æª”æ¡ˆ
â”‚   â””â”€â”€ ExportVirtualDialog.jsx      # åŒ¯å‡ºå°è©±æ¡† (NEW)
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useVirtualImage.js           # è™›æ“¬åœ–ç‰‡è™•ç† Hook (NEW)
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ repicFile.js                 # .repic æª”æ¡ˆè®€å¯«å·¥å…· (NEW)
â””â”€â”€ i18n/locales/
    â”œâ”€â”€ en.json                      # æ–°å¢ç¿»è­¯
    â””â”€â”€ zh-TW.json                   # æ–°å¢ç¿»è­¯

electron/
â”œâ”€â”€ main.js                          # æª”æ¡ˆé—œè¯è™•ç†
â””â”€â”€ preload.js                       # æ–°å¢ IPC API
```

---

## å¯¦ä½œæ­¥é©Ÿ

### Phase 1: åŸºç¤æ¶æ§‹
1. æ›´æ–° `electron-builder` è¨­å®šï¼Œè¨»å†Š `.repic` æª”æ¡ˆé—œè¯
2. ä¿®æ”¹ `main.js`ï¼Œè™•ç†é–‹æª”äº‹ä»¶
3. ä¿®æ”¹ `preload.js`ï¼Œæ–°å¢ IPC API
4. å»ºç«‹ `repicFile.js` å·¥å…·å‡½å¼

### Phase 2: é–‹æª”è™•ç†
5. ä¿®æ”¹ `App.jsx`ï¼Œç›£è½ `open-virtual-image` äº‹ä»¶
6. å¯¦ç¾å–®æª”é–‹å•Ÿç€è¦½æ¨¡å¼
7. æ”¯æ´åŒè³‡æ–™å¤¾å…¶ä»– `.repic` æª”æ¡ˆåˆ‡æ›

### Phase 3: æœ¬åœ°æ¨¡å¼æ•´åˆ
8. ä¿®æ”¹ç›®éŒ„è®€å–é‚è¼¯ï¼ŒåŒ…å« `.repic` æª”æ¡ˆ
9. ä¿®æ”¹ `Sidebar.jsx`ï¼Œæ”¯æ´æ··åˆé¡¯ç¤º
10. è™›æ“¬åœ–ç‰‡ç¸®åœ–è¼‰å…¥ï¼ˆé¡¯ç¤ºç¶²è·¯åœ–ç‰‡æˆ– LOGO placeholderï¼‰

### Phase 4: åŒ¯å‡ºåŠŸèƒ½
11. å»ºç«‹ `ExportVirtualDialog.jsx`
12. ç¶²è·¯ç›¸ç°¿æ–°å¢ã€ŒåŒ¯å‡ºæ·å¾‘ã€æŒ‰éˆ•
13. å¯¦ç¾æ‰¹é‡ç”Ÿæˆ `.repic` æª”æ¡ˆ
14. æ›´æ–° i18n ç¿»è­¯

---

## é©—è­‰æ–¹å¼

### åŸºæœ¬æµç¨‹æ¸¬è©¦
```
1. ç¶²è·¯ç›¸ç°¿å»ºç«‹ç›¸ç°¿ â†’ åŠ å…¥ 5 å¼µåœ–ç‰‡
2. é»æ“Šã€ŒåŒ¯å‡ºæ·å¾‘ã€â†’ é¸æ“‡è³‡æ–™å¤¾ â†’ ç¢ºèª
3. æª”æ¡ˆç¸½ç®¡ä¸­çœ‹åˆ° 5 å€‹ .repic æª”æ¡ˆï¼Œåœ–ç¤ºç‚º Repic LOGO
4. é›™æ“Šä»»ä¸€ .repic â†’ Repic é–‹å•Ÿ â†’ é¡¯ç¤ºå°æ‡‰åœ–ç‰‡
5. æŒ‰å·¦å³éµ â†’ å¯åˆ‡æ›åŒè³‡æ–™å¤¾å…¶ä»– .repic åœ–ç‰‡
```

### æœ¬åœ°æ¨¡å¼æ¸¬è©¦
```
1. åœ¨è³‡æ–™å¤¾æ”¾å…¥æ··åˆæª”æ¡ˆï¼š3 å¼µ JPG + 2 å€‹ .repic
2. Repic é–‹å•Ÿè©²è³‡æ–™å¤¾
3. å´é‚Šæ¬„é¡¯ç¤º 5 å€‹é …ç›®ï¼ˆæ··åˆæ’åˆ—ï¼‰
4. é»æ“Š .repic é …ç›® â†’ é¡¯ç¤ºç¶²è·¯åœ–ç‰‡
5. é»æ“Š JPG é …ç›® â†’ é¡¯ç¤ºæœ¬åœ°åœ–ç‰‡
```

### é‚Šç•Œæ¸¬è©¦
- `.repic` æª”æ¡ˆæå£æˆ–æ ¼å¼éŒ¯èª¤ â†’ é¡¯ç¤ºéŒ¯èª¤æç¤º
- URL å¤±æ•ˆ â†’ é¡¯ç¤ºè¼‰å…¥å¤±æ•—åœ–ç¤º
- é›¢ç·šç‹€æ…‹ â†’ é¡¯ç¤ºã€Œéœ€è¦ç¶²è·¯é€£ç·šã€æç¤º

---

## i18n ç¿»è­¯

### en.json
```json
{
  "exportVirtual": "Export Shortcuts",
  "exportVirtualTitle": "Export Virtual Image Shortcuts",
  "targetFolder": "Target Folder",
  "browse": "Browse...",
  "filenameFormat": "Filename Format",
  "useImageName": "Use image name",
  "useNumberedName": "Add sequence number",
  "exporting": "Exporting...",
  "exportSuccess": "Exported {count} shortcuts",
  "exportFailed": "Export failed: {error}",
  "virtualImage": "Virtual Image",
  "loadingImage": "Loading image...",
  "networkRequired": "Network connection required"
}
```

### zh-TW.json
```json
{
  "exportVirtual": "åŒ¯å‡ºæ·å¾‘",
  "exportVirtualTitle": "åŒ¯å‡ºè™›æ“¬åœ–ç‰‡æ·å¾‘",
  "targetFolder": "ç›®æ¨™è³‡æ–™å¤¾",
  "browse": "ç€è¦½...",
  "filenameFormat": "æª”åæ ¼å¼",
  "useImageName": "ä½¿ç”¨åœ–ç‰‡åç¨±",
  "useNumberedName": "åŠ ä¸Šåºè™Ÿ",
  "exporting": "åŒ¯å‡ºä¸­...",
  "exportSuccess": "å·²åŒ¯å‡º {count} å€‹æ·å¾‘",
  "exportFailed": "åŒ¯å‡ºå¤±æ•—ï¼š{error}",
  "virtualImage": "è™›æ“¬åœ–ç‰‡",
  "loadingImage": "è¼‰å…¥åœ–ç‰‡ä¸­...",
  "networkRequired": "éœ€è¦ç¶²è·¯é€£ç·š"
}
```

---

## æœªä¾†æ“´å±•

1. **æ‰¹é‡åŒ¯å…¥** - æ‹–æ›³å¤šå€‹ URL å»ºç«‹ `.repic` æª”æ¡ˆ
2. **åŒæ­¥åŠŸèƒ½** - `.repic` æª”æ¡ˆèˆ‡ç¶²è·¯ç›¸ç°¿é›™å‘åŒæ­¥
3. **é›¢ç·šå¿«å–** - å¯é¸æ“‡æ€§å¿«å–ç¸®åœ–
4. **æ¨™ç±¤ç³»çµ±** - åœ¨ `.repic` æª”æ¡ˆä¸­å„²å­˜æ¨™ç±¤ metadata
